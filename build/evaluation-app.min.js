var app=angular.module("EvaluationApp",["ngRoute"]);app.config(function(a){a.when("/home/",{templateUrl:"templates/home.html",controller:"HomeController"}).when("/evaluation/:evaluationID",{templateUrl:"templates/evaluation.html",controller:"EvaluationController"}).when("/evaluation/",{templateUrl:"templates/evaluation.html",controller:"EvaluationController"}).when("/",{templateUrl:"templates/login.html",controller:"LoginController"}).otherwise({redirectTo:"/"})}),app.controller("EvaluationController",["$scope","ApiFactory","$routeParams",function(a,b,c){var d=c.evaluationID;void 0!==d?b.getEvaluationById(d).then(function(b){a.evaluation=b},function(a){console.log("Error fetching evaluation: "+a)}):a.evaluation={TitleIS:"",TitleEN:"",IntroTextIS:"",IntroTextEN:"",CourseQuestions:[],TeacherQuestions:[]},a.addAnswer=function(a){a.Answers.push("New answer")},a.addCourseQuestion=function(){a.evaluation.CourseQuestions.push({ID:a.evaluation.CourseQuestions.length,TextIS:"",TextEN:"",ImageURL:"",Type:"single",Answers:[]})}}]),app.controller("HomeController",["$scope","ApiFactory",function(a,b){b.getAllEvaluations().then(function(b){console.log("Success, data: ",b),a.evaluations=b},function(a){console.log("Error: "+a)},function(a){console.log("Update: "+a)})}]),app.controller("LoginController",["$scope","ApiFactory",function(a,b){a.login={userName:"",password:""},a.login=function(a){console.log("Logged in"),b.login(a.user,a.pass).then(function(a){console.log("THE TOKEN: "+a)},function(){console.log("Could not log in.")})}}]),app.factory("ApiFactory",["$q","$timeout","$http",function(a,b,c){function d(a,b,c,d,e){return{ID:a,TitleIS:b,TitleEN:c,IntroTextIS:d,IntroTextEN:e,CourseQuestions:[],TeacherQuestions:[]}}function e(a,b,c,d,e){return{ID:a,TextIS:b,TextEN:c,ImageURL:d,Type:e,Answers:[]}}function f(){for(var a=[],b=0;5>b;++b){for(var c=b+1,f=d(b,"Kennslumat "+c,"Evaluation "+c,"Derp","Derp"),g=0;3>g;++g){var h=g+1,i=e(g,"Hva√∞ er derp"+h+"?","What is derp "+h+"?","","single");f.CourseQuestions.push(i)}a.push(f)}return a}var g=f(),h="http://project3api.haukurhaf.net/",i="";return{getAllEvaluations:function(){var b=a.defer();return b.resolve(g),b.promise},getEvaluationById:function(b){var c=a.defer();return g[b]?c.resolve(g[b]):c.reject("No evaluation with this id"),c.promise},addEvaluation:function(){var b=a.defer();return b.promise},login:function(b,d){{var e=a.defer();c.post(h+"api/v1/login",{user:b,pass:d}).success(function(a){i=a.Token,e.resolve(i)}).error(function(){e.reject("Failed to log in.")})}return e.promise}}}]);